<head> <meta charset="utf-8" </head>
                      <div id="content_views" class="htmledit_views">
                    <article class="post_article" style="font-size: 16px;"> 
 <h3>1 next数组</h3> 
 <pre><code class="has">void getNext(string s){
    int j = -1;
    next[0] = -1;   //初始化:j = next[0] = -1
    for (int i = 1; i &lt; s.size(); i++){
        while (j != -1 &amp;&amp; s[i] != s[j + 1]) {
            j = next[j];
        }
        if (s[i] == s[j + 1]){
            j++;
        }
        next[i] = j;
    }
}</code>



</pre>
 <h3>2 KMP算法</h3> 
 <p>判断模式串pattern是否出现在文本串text中，时间复杂度O(M+N)</p> 
 <pre><code class="has">bool KMP(string text, string pattern){
  getNext(pattern);
  int j = -1;
  for (int i = 0; i &lt; text.size(); i++){
    while (j != -1 &amp;&amp; text[i] != pattern[j + 1]) {
      j = next[j];
    }
    if (text[i] == pattern[j + 1]){
      j++;
    }
    if (j == pattren.size() - 1) return true;
  }
  return false;
}</code>



</pre>
 <p>统计模式串pattern在文本串中出现的次数，时间复杂度O(M+N)</p> 
 <pre><code class="has">int KMP(string text, string pattern){
  getNext(pattern);
  int j = -1, ans = 0;
  for (int i = 0; i &lt; text.size(); i++){
    while (j != -1 &amp;&amp; text[i] != pattern[j + 1]) {
      j = next[j];
    }
    if (text[i] == pattern[j + 1]){
      j++;
    }
    if (j == pattren.size() - 1) {
      ans++;
      j = next[j];
    }
  }
  return ans;
}</code>



</pre>
 <h3>3 字符串模式匹配KMP完整代码</h3> 
 <pre><code class="has">#include &lt;cstdio&gt;
#include &lt;iostream&gt;
#include &lt;cstring&gt;
#include &lt;string&gt;
using namespace std;
const int MAXN = 1000;
int Next[MAXN];

void getNext(string s){
    int j = -1;
    Next[0] = -1;
    for (int i = 1; i &lt; s.size(); i++){     //注意这里是i = 1
        while (j != -1 &amp;&amp; s[i] != s[j + 1]){
            j = Next[j];
        }
        if (s[i] == s[j + 1]){
            j++;
        }
        Next[i] = j;
    }
}

bool KMP(string text, string pattern){
    getNext(pattern);
    int j = -1;
    for (int i = 0; i &lt; text.size(); i++){
        while (j != -1 &amp;&amp; text[i] != pattern[j + 1]){
            j = Next[j];
        }
        if (text[i] == pattern[j + 1]){
            j++;
        }
        if (j == pattern.size() - 1) return true;
    }
    return false;
}

int main(){
    string text, pattern;
    cin &gt;&gt; text &gt;&gt; pattern;
    if (KMP(text, pattern)) cout &lt;&lt; "YES" &lt;&lt; endl;
    else cout &lt;&lt; "NO" &lt;&lt; endl;
    return 0;
}</code>
        </pre>
</article>
                </div>
        