<head> <meta charset="utf-8" </head>
                      <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>学习目标：理解赛题背景和赛题数据，完成赛题报名和数据下载，理解赛题的解题思路</p> 
</blockquote> 
<p>首先贴出Datawhale开源项目链接和天池赛事报名链接：</p> 
<p><a href="https://github.com/datawhalechina/team-learning/tree/master/03%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%AE%9E%E8%B7%B5%EF%BC%88%E8%A1%97%E6%99%AF%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E8%AF%86%E5%88%AB%EF%BC%89">Datawhale开源项目链接</a></p> 
<p><a href="https://tianchi.aliyun.com/competition/entrance/531795/introduction">天池赛事报名链接</a></p> 
<p>该项目为Datawhale和天池合作举办的cv入门赛事街景字符识别开源项目，比较适合刚入门深度学习并且想要找项目练手的同学们。</p> 
<h2><a id="1__9"></a>1 赛题背景</h2> 
<p>谷歌街景，是谷歌地图的一项特色服务，是由专用街景车进行拍摄，然后把360度实景拍摄照片放在谷歌地图里供用户使用。</p> 
<p>该赛题即来源于Google街景图片中的门牌号识别问题。</p> 
<p>我们知道，在受约束环境下（如文档处理）的字符识别技术，比方说OCR技术已经被研究得很透。但是对照片中的多字符文本识别却是个难题，因为这些照片中的字体、颜色、样式、方向、排列不一，再加上光照、阴影、镜像、遮蔽等环境因素影响，还有图像本身的分辨率、焦点模糊、抖动等问题。而传统的图像文字识别，一般要经过字符定位、分割和识别三个步骤，处理效率不高。考虑Google街景的每天上传的图片量，以往的这些方法显然缺乏实用价值。</p> 
<p>为此，Google开发了一套大型的神经网络来处理海量的Google街景图片中的门牌号识别问题。这个神经网络的代号是DistBelief，其学名是深度卷积神经网络。经过DistBelief训练的这个大型分布式神经网络，可以把定位、分割和识别三个步骤集成到一起，直接对每一个像素进行操作。其性能随着神经网络的深度增加而提高，在11层的时候达到最高。根据论文的数据，该系统对SVHN（街景门牌号数据集）中的门牌号识别率达96%，而单数字识别率达97.84%，对于Google街景图库的上千万门牌号的识别率也超过90%。</p> 
<p>此处附上论文下载链接：https://pan.baidu.com/s/1Z3g1pps_pP_Ef849vslHWg 提取码：220B</p> 
<h2><a id="2__23"></a>2 赛题数据</h2> 
<p>赛题来源自Google街景图像中的门牌号数据集<a href="http://ufldl.stanford.edu/housenumbers/">SVHN</a>（The Street View House Numbers Dataset,），并根据一定方式采样得到比赛数据集。需要注意的是本赛题需要选手识别图片中所有的字符，为了降低比赛难度，我们提供了训练集、验证集和测试集中字符的位置框（如下图所示）。<br> <img src="https://img-blog.csdnimg.cn/20200520105434413.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3doYXRpc2NvZGU=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> 
<h3><a id="_28"></a>数据集</h3> 
<p>训练集数据包括3W张照片，验证集数据包括1W张照片，每张照片包括颜色图像和对应的编码类别和具体位置；为了保证比赛的公平性，测试集A包括4W张照片，测试集B包括4W张照片。</p> 
<h3><a id="_32"></a>字段表</h3> 
<p>所有的数据（训练集、验证集和测试集）的标签（label）使用JSON格式，并使用文件名进行索引。如果一个文件中包括多个字符，则使用列表将字段进行组合。</p> 
<table><thead><tr><th align="center">Field</th><th align="center">Description</th></tr></thead><tbody><tr><td align="center">top</td><td align="center">左上角坐标X</td></tr><tr><td align="center">height</td><td align="center">字符高度</td></tr><tr><td align="center">left</td><td align="center">左上角最表Y</td></tr><tr><td align="center">width</td><td align="center">字符宽度</td></tr><tr><td align="center">label</td><td align="center">字符编码</td></tr></tbody></table>
<p>字符的具体坐标如下图：<br> <img src="https://img-blog.csdnimg.cn/20200520105854552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3doYXRpc2NvZGU=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br> 在比赛数据（训练集和验证集）中，同一张图片中可能包括一个或者多个字符，因此在比赛数据的JSON标注中，会有两个字符的边框信息：<br> <img src="https://img-blog.csdnimg.cn/2020052010595394.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3doYXRpc2NvZGU=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> 
<h2><a id="3__48"></a>3 评测指标</h2> 
<p>选手提交结果与实际图片的编码进行对比，以编码整体识别准确率为评价指标。任何一个字符错误都为错误，最终评测指标结果越大越好，具体计算公式如下：<br> <img src="https://img-blog.csdnimg.cn/20200520110014975.png#pic_center" alt="在这里插入图片描述"></p> 
<h2><a id="4__54"></a>4 结果提交</h2> 
<p>提交前请确保预测结果的格式与sample_submit.csv中的格式一致，以及提交文件后缀名为csv。</p> 
<pre><code>file_name, file_code
0010000.jpg,451
0010001.jpg,232
0010002.jpg,45
0010003.jpg,67
0010004.jpg,191
0010005.jpg,892
</code></pre> 
<h2><a id="5__68"></a>5 数据读取</h2> 
<p>JSON中标签的读取方式：</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取图片中位置框里面的字符</span>
<span class="token keyword">import</span> json
train_json <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'../input/train.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 数据标注处理</span>
<span class="token keyword">def</span> <span class="token function">parse_json</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span>
   arr <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
       d<span class="token punctuation">[</span><span class="token string">'top'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token string">'left'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  d<span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>
   <span class="token punctuation">]</span><span class="token punctuation">)</span>
   arr <span class="token operator">=</span> arr<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
   <span class="token keyword">return</span> arr

img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'../input/train/000000.png'</span><span class="token punctuation">)</span>
arr <span class="token operator">=</span> parse_json<span class="token punctuation">(</span>train_json<span class="token punctuation">[</span><span class="token string">'000000.png'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> arr<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> arr<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> idx<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>
   plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">[</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> idx<span class="token punctuation">]</span><span class="token punctuation">:</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> idx<span class="token punctuation">]</span><span class="token operator">+</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> idx<span class="token punctuation">]</span><span class="token punctuation">,</span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> idx<span class="token punctuation">]</span><span class="token punctuation">:</span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> idx<span class="token punctuation">]</span><span class="token operator">+</span>arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> idx<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
   plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
   plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="6__102"></a>6 解题思路</h2> 
<p>赛题思路分析：赛题本质是分类问题，需要对图片的字符进行识别。但赛题给定的数据图片中不同图片中包含的字符数量不等。比如说在本文中的第一张图里面，有的图片的字符个数为2，有的图片字符个数为3，有的图片字符个数为4。</p> 
<p>因此本次赛题的<strong>难点</strong>是需要对不定长的字符进行识别，与传统的图像分类任务有所不同。为了降低参赛难度，大佬们提供了以下解题思路：</p> 
<h3><a id="1_108"></a>(1)简单入门思路：定长字符识别</h3> 
<p>可以将赛题抽象为一个定长字符识别问题，在赛题数据集中大部分图像中字符个数为2-4个，最多的字符个数为6个。因此可以对于所有的图像都抽象为6个字符的识别问题，字符23填充为23XXXX，字符231填充为231XXX。</p> 
<p>经过填充之后，原始的赛题可以简化了6个字符的分类问题。在每个字符的分类中会进行11个类别的分类，假如分类为填充字符，则表明该字符为空。</p> 
<h3><a id="2_114"></a>(2)专业字符识别思路：不定长字符识别</h3> 
<p>在字符识别研究中，有特定的方法来解决此种不定长的字符识别问题，比较典型的有CRNN字符识别模型。<br> 在本次赛题中给定的图像数据都比较规整，可以视为一个单词或者一个句子。</p> 
<h3><a id="3_119"></a>(3)专业分类思路：检测再识别</h3> 
<p>在赛题数据中已经给出了训练集、验证集中所有图片中字符的位置，因此可以首先将字符的位置进行识别，利用物体检测的思路完成。</p> 
<p>此种思路需要参赛选手构建字符检测模型，对测试集中的字符进行识别。选手可以参考物体检测模型SSD或者YOLO来完成。</p> 
<h2><a id="7__127"></a>7 总结</h2> 
<p>首先很感谢Datawhale和天池能够提供一个这么好的开源项目，让我们这些对深度学习感兴趣的小白们也有机会参与到实践当中，并且认识到了一群志同道合的小伙伴们。项目中不仅提供了每一步的具体流程和代码，还会定期有大佬直播分享经验，并且还能和队友们一起讨论，互相监督。</p> 
<p>经过这几天的学习，认知到自己的不足，尤其是实践方面；所以在这里定下一些小目标，希望在这个项目结束后能够有所收获：</p> 
<ol><li>能够基本学会PyTorch框架</li><li>阅读5篇以上相关论文</li><li>每天按时汇报情况并归纳笔记</li></ol>
                </div>
                