<head> <meta charset="utf-8" </head>
                      <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>学习目标：学习Python和PyTorch中图像读取；学会数据扩增方法；使用PyTorch读取赛题数据</p> 
</blockquote> 
<h2><a id="1_Python_2"></a>1 Python图像读取</h2> 
<p>由于赛题数据是图像数据，赛题的任务是识别图像中的字符。因此我们首先需要完成对数据的读取操作，在Python中有很多库可以完成数据读取的操作，比较常见的有Pillow和OpenCV。</p> 
<h3><a id="11_Pillow_6"></a>1.1 Pillow函数库</h3> 
<p>Pillow是Python图像处理函式库(PIL）的一个分支。PIL是一个函式库，提供了几个操作图像的标准程序。它是一个功能强大的函式库，但自2011年以来就没有太多的更新，并且不支持Python3。</p> 
<p>Pillow在PIL的基础上，为Python3增加了更多功能和支持。它支持一系列图像文件格式PNG,JPEG,PPM,GIF,TIFF和BMP。我们将看到如何在图像上执行各种操作，例如裁剪，调整大小，添加文本到图像，旋转，灰阶转换。</p> 
<p>Pillow的官方文档：https://pillow.readthedocs.io/en/stable/</p> 
<h4><a id="Pillow_14"></a>Pillow的基本操作</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 导入Pillow库</span>
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageFilter

<span class="token comment"># 读取并展示图片</span>
im <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"cat.png"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>im<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>im<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 调整图像的大小</span>
im2 <span class="token operator">=</span> im<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 图像缩图（thumbnail）:会保持长宽比例</span>
im<span class="token punctuation">.</span>thumbnail<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>im<span class="token punctuation">.</span>size<span class="token punctuation">)</span>

<span class="token comment"># 应用模糊滤镜</span>
im2 <span class="token operator">=</span> im<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>ImageFilter<span class="token punctuation">.</span>BLUR<span class="token punctuation">)</span>
im2<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"blur.png"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="12_OpenCV_41"></a>1.2 OpenCV</h3> 
<p>OpenCV是一个跨平台的计算机视觉库，最早由Intel开源得来。OpenCV发展的非常早，拥有众多的计算机视觉、数字图像处理和机器视觉等功能。OpenCV在功能上比Pillow更加强大很多，学习成本也高很多。</p> 
<p>OpenCV包含了众多的图像处理的功能，OpenCV包含了你能想得到的只要与图像相关的操作。此外OpenCV还内置了很多的图像特征处理算法，如关键点检测、边缘检测和直线检测等。</p> 
<p>OpenCV官网：https://opencv.org/</p> 
<p>OpenCV Github：https://github.com/opencv/opencv</p> 
<p>OpenCV 扩展算法库：https://github.com/opencv/opencv_contrib</p> 
<h4><a id="OpenCV_53"></a>OpenCV的基本操作</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 导入OpenCv库</span>
<span class="token keyword">import</span> cv2

<span class="token comment"># 读取并展示图片</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'cat.png'</span><span class="token punctuation">)</span>
<span class="token comment"># OpenCv默认颜色通道顺序是BRG，转换一下</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 转换为灰度图</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>

<span class="token comment"># Canny边缘检测</span>
edges <span class="token operator">=</span> cv2<span class="token punctuation">.</span>Canny<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">'canny.jpg'</span><span class="token punctuation">,</span> edges<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="2__77"></a>2 数据扩增方法</h2> 
<p>在赛题中我们需要对的图像进行字符识别，因此既需要我们完成对数据的读取操作，同时也需要完成数据扩增（Data Augmentation）操作。</p> 
<p><img src="https://img-blog.csdnimg.cn/20200523155921836.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3doYXRpc2NvZGU=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> 
<h3><a id="21__83"></a>2.1 数据扩增介绍</h3> 
<p>在深度学习中数据扩增方法非常重要，数据扩增可以增加训练集的样本，同时也可以有效缓解模型过拟合的情况，也可以给模型带来的更强的泛化能力。</p> 
<h4><a id="_87"></a>数据扩增为什么有用？</h4> 
<p>在深度学习模型的训练过程中，数据扩增是必不可少的环节。现有深度学习的参数非常多，一般的模型可训练的参数量基本上都是万到百万级别，而训练集样本的数量很难有这么多。</p> 
<p>其次数据扩增可以扩展样本空间，假设现在的分类模型需要对汽车进行分类，左边的是汽车A，右边为汽车B。如果不使用任何数据扩增方法，深度学习模型会从汽车车头的角度来进行判别，而不是汽车具体的区别。</p> 
<p><img src="https://img-blog.csdnimg.cn/20200523155949253.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3doYXRpc2NvZGU=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> 
<h4><a id="_95"></a>有哪些数据扩增方法？</h4> 
<p>数据扩增方法有很多：从颜色空间、尺度空间到样本空间，同时根据不同任务数据扩增都有相应的区别。<br> 对于图像分类，数据扩增一般不会改变标签；对于物体检测，数据扩增会改变物体坐标位置；对于图像分割，数据扩增会改变像素标签。</p> 
<h3><a id="22__100"></a>2.2 常见的数据扩增方法</h3> 
<p>在常见的数据扩增方法中，一般会从图像颜色、尺寸、形态、空间和像素等角度进行变换。当然不同的数据扩增方法可以自由进行组合，得到更加丰富的数据扩增方法。</p> 
<p>以torchvision为例，常见的数据扩增方法包括：</p> 
<ul><li>transforms.CenterCrop 对图片中心进行裁剪</li><li>transforms.ColorJitter 对图像颜色的对比度、饱和度和零度进行变换</li><li>transforms.FiveCrop 对图像四个角和中心进行裁剪得到五分图像</li><li>transforms.Grayscale 对图像进行灰度变换</li><li>transforms.Pad 使用固定值进行像素填充</li><li>transforms.RandomAffine 随机仿射变换</li><li>transforms.RandomCrop 随机区域裁剪</li><li>transforms.RandomHorizontalFlip 随机水平翻转</li><li>transforms.RandomRotation 随机旋转</li><li>transforms.RandomVerticalFlip 随机垂直翻转</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/20200523160015962.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3doYXRpc2NvZGU=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p> 
<h3><a id="23__119"></a>2.3 常用的数据扩增库</h3> 
<h4><a id="torchvision_121"></a>torchvision</h4> 
<p>https://github.com/pytorch/vision<br> pytorch官方提供的数据扩增库，提供了基本的数据数据扩增方法，可以无缝与torch进行集成；但数据扩增方法种类较少，且速度中等。</p> 
<h4><a id="imgaug_126"></a>imgaug</h4> 
<p>https://github.com/aleju/imgaug<br> imgaug是常用的第三方数据扩增库，提供了多样的数据扩增方法，且组合起来非常方便，速度较快。</p> 
<h4><a id="albumentations_131"></a>albumentations</h4> 
<p><a href="https://albumentations.readthedocs.io/">https://albumentations.readthedocs.io</a><br> 是常用的第三方数据扩增库，提供了多样的数据扩增方法，对图像分类、语义分割、物体检测和关键点检测都支持，速度较快。</p> 
<h2><a id="3_PyTorch_138"></a>3 PyTorch读取数据</h2> 
<p>在PyTorch中数据是通过<strong>Dataset</strong>进行封装，并通过<strong>DataLoder</strong>进行并行读取。如果想个性化自己的数据集或者数据读取方式，则需要自己重写子类。</p> 
<ul><li>Dataset：对数据集的封装，提供索引方式的对数据样本进行读取</li><li>DataLoder：对Dataset进行封装，提供批量读取的迭代读取</li></ul> 
<h3><a id="31_Dateset_145"></a>3.1 Dateset</h3> 
<p><code>torch.utils.data.Dataset</code>是一个抽象类，自定义的Dataset需要<strong>继承</strong>它并且实现两个成员方法:<code>__getitem__()</code> 和 <code>__len__()</code></p> 
<p><code>__getitem__()</code>, 即从所给路径中读取数据及其标签:</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    img_path<span class="token punctuation">,</span> label <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>img_path<span class="token punctuation">,</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>label
    img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>img_path<span class="token punctuation">)</span>
    <span class="token keyword">return</span> img<span class="token punctuation">,</span> label
</code></pre> 
<p>值得一提的是, pytorch还提供了很多常用的transform, 在<code>torchvision.transforms</code> 里面, 常用的有<code>Resize</code> , <code>RandomCrop</code> , <code>Normalize</code> , <code>ToTensor</code></p> 
<p><code>__len__()</code>比较简单, 就是返回整个数据集的长度:</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre> 
<p>下面是baseline中用Dataset对数据集进行封装的代码的代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> glob<span class="token punctuation">,</span> shutil<span class="token punctuation">,</span> json
<span class="token keyword">import</span> cv2

<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">import</span> torch
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>dataset <span class="token keyword">import</span> Dataset
<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms

<span class="token keyword">class</span> <span class="token class-name">SVHNDataset</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>
  	<span class="token comment"># 初始化方法</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img_path<span class="token punctuation">,</span> img_label<span class="token punctuation">,</span> transform<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>img_path <span class="token operator">=</span> img_path
        self<span class="token punctuation">.</span>img_label <span class="token operator">=</span> img_label 
        <span class="token keyword">if</span> transform <span class="token keyword">is</span> <span class="token operator">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>transform <span class="token operator">=</span> transform
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token boolean">None</span>
		
    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>
        img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>img_path<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>transform <span class="token keyword">is</span> <span class="token operator">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            img <span class="token operator">=</span> self<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
        
        <span class="token comment"># 原始SVHN中类别10为数字0，采用定长字符识别</span>
        lbl <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>self<span class="token punctuation">.</span>img_label<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">)</span>
        lbl <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>lbl<span class="token punctuation">)</span>  <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lbl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span>
        
        <span class="token keyword">return</span> img<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>lbl<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>img_path<span class="token punctuation">)</span>

<span class="token comment"># glob() 函数返回匹配指定模式的文件名或目录。</span>
train_path <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'../input/train/*.png'</span><span class="token punctuation">)</span>
train_path<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
train_json <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'../input/train.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
train_label <span class="token operator">=</span> <span class="token punctuation">[</span>train_json<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> train_json<span class="token punctuation">]</span>

<span class="token comment">################</span>
<span class="token comment">#未加入DataLoader</span>
data <span class="token operator">=</span> SVHNDataset<span class="token punctuation">(</span>train_path<span class="token punctuation">,</span> train_label<span class="token punctuation">,</span>
          transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
              <span class="token comment"># 缩放到固定尺寸</span>
              transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

              <span class="token comment"># 随机颜色变换</span>
              transforms<span class="token punctuation">.</span>ColorJitter<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

              <span class="token comment"># 加入随机旋转</span>
              transforms<span class="token punctuation">.</span>RandomRotation<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

              <span class="token comment"># 将图片转换为pytorch 的tesntor</span>
              <span class="token comment"># transforms.ToTensor(),</span>

              <span class="token comment"># 对图像像素进行归一化</span>
              <span class="token comment"># transforms.Normalize([0.485,0.456,0.406],[0.229,0.224,0.225])</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="32_DataLoader_232"></a>3.2 DataLoader</h3> 
<p><code>torch.utils.data.DataLoader</code> 的类定义为：</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">torch</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> sampler<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> batch_sampler<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> num_workers<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> collate_fn<span class="token operator">=</span><span class="token operator">&lt;</span>function default_collate<span class="token operator">&gt;</span><span class="token punctuation">,</span> pin_memory<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> drop_last<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<p>主要有以下几个参数：</p> 
<ol><li><code>dataset</code> : 即上面自定义的dataset.</li><li><code>batch_size</code>: 每一批样本数.</li><li><code>shuffle</code>: 是否打乱顺序.</li><li><code>num_worker</code>: 读取的线程个数, 只要设置为&gt;=1, 就可以多线程预读数据啦.</li><li><code>collate_fn</code>: 这个函数用来打包batch.</li></ol> 
<p>使用DataLoader后只有最后部分的代码和上面Dataset的代码有区别，具体代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">################</span>
<span class="token comment">#加入了DataLoader</span>
train_loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>
        SVHNDataset<span class="token punctuation">(</span>train_path<span class="token punctuation">,</span> train_label<span class="token punctuation">,</span>
                   transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
                       transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       transforms<span class="token punctuation">.</span>ColorJitter<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       transforms<span class="token punctuation">.</span>RandomRotation<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    batch_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment"># 每批样本个数</span>
    shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token comment"># 是否打乱顺序</span>
    num_workers<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment"># 读取的线程个数</span>
<span class="token punctuation">)</span>

<span class="token keyword">for</span> data <span class="token keyword">in</span> train_loader<span class="token punctuation">:</span>
    <span class="token keyword">break</span>
</code></pre> 
<p>在加入DataLoder后，数据按照批次获取，每批次调用Dataset读取单个样本进行拼接。此时data的格式为：<br> <code>torch.Size([10, 3, 64, 128]), torch.Size([10, 6])</code><br> 前者为图像文件，为batchsize * chanel * height * width次序；后者为字符标签。</p> 
<h2><a id="4__277"></a>4 小结</h2> 
<p>通过完成本次Task，了解了以下知识点：</p> 
<ol><li>Python中读取图像数据。主要用到了Pillow库和OpenCV库。</li><li>Python中数据扩增方法。数据扩增可以增加训练集的样本，从而可以缓解模型过拟合的情况，同时也可以给模型带来更强的泛化能力。常用的数据扩增库主要有：torchvision、imgaug、albumentations等等。</li><li>PyTorch读取数据。使用到了Dataset和DateLoader两个类。</li></ol> 
<h2><a id="_521_286"></a>附录 5月21日直播小结</h2> 
<h3><a id="Baseline_288"></a>Baseline中的知识点</h3> 
<ol><li>使用PyTorch读取数据集</li><li>构建多分类模型</li><li>使用ImageNet预训练模型进行微调</li><li>构建训练集和验证集</li><li>模型保存用于加载</li></ol> 
<h3><a id="Baseline1345_298"></a>Baseline如何继续深入，提高精度？（1～3实现比较简单，4～5较难）</h3> 
<ol><li>首先提高单模型在20个Epoch以内的精度（单纯baseline思路，是榜单0.7+左右的思路）</li><li>尝试加入其他数据扩增方法（比如模糊和像素噪音）</li><li>尝试进行多折预测结果集成（训练两折、把训练集和验证集的训练样本拼接到一起）</li><li>尝试其他模型，或者改进模型的多字符训练过程；（比如修改多字符分类的损失函数）</li><li>尝试其他模型，对结果进行修正（比如训练一个字符字数预测模型，对结果进行修正）</li></ol> 
<h3><a id="_308"></a>其他尝试和思考</h3> 
<ul><li>这个赛题需要使用物体/字符检测模型吗？</li><li>如何复用YOLO、SSD或者Faster-RCNN模型？</li></ul>
                </div>
                